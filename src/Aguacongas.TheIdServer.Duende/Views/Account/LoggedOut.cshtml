@* 
Project: Aguafrommars/TheIdServer
Copyright (c) 2025 @Olivier Lefebvre

-----------------------------------------------------------------------------

View: LoggedOut
Purpose:
    Displays the logged out page to the user after sign-out.
    - Shows a message confirming logout.
    - Optionally provides a redirect link back to the client application.
    - Optionally renders a sign-out iframe for federated sign-out.
    - Optionally includes a script for automatic redirect after sign-out.

Model:
    LoggedOutViewModel
        - PostLogoutRedirectUri: string? (URL to redirect after logout)
        - ClientName: string? (Name of the client application)
        - SignOutIframeUrl: string? (URL for federated sign-out iframe)
        - AutomaticRedirectAfterSignOut: bool (If true, triggers automatic redirect)

Localization:
    Uses IViewLocalizer for localizing UI strings.

Usage:
    This view is rendered after a user logs out, typically as part of an authentication flow.

------------------------------------------------------------------------------
*@

@inject IViewLocalizer Localizer

@model LoggedOutViewModel

@{
    // Indicates to the layout that the user is signed out.
    ViewData["signed-out"] = true;
}

<div class="page-header logged-out">
    <h1>
        @* Localized logout confirmation header *@
        @Localizer["Logout"]
        <small>@Localizer["You are now logged out"]</small>
    </h1>

    @* If a post-logout redirect URI is provided, show a link to return to the client application *@
    @if (Model.PostLogoutRedirectUri != null)
    {
        <div>
            @Localizer["Click <a class=\"PostLogoutRedirectUri\" href=\"{0}\">here</a> to return to the <span>{1}</span> application.", Model.PostLogoutRedirectUri, Model.ClientName!]
        </div>
    }

    @* If a sign-out iframe URL is provided, render the iframe for federated sign-out *@
    @if (Model.SignOutIframeUrl != null)
    {
        <iframe title="signout" width="0" height="0" class="signout" src="@Model.SignOutIframeUrl"></iframe>
    }
</div>

@section scripts
{
    @* If automatic redirect is enabled, include the signout-redirect script *@
    @if (Model.AutomaticRedirectAfterSignOut)
    {
        <script src="~/js/signout-redirect.js"></script>
    }
}
